{
  "description": "Azure WAF Scanner Configuration File",
  "version": "1.0",
  
  "excludedPillars": [],
  
  "excludedChecks": [],
  
  "customThresholds": {
    "costManagement": {
      "monthlyBudgetWarningPercent": 80,
      "monthlyBudgetCriticalPercent": 95,
      "unusedResourceAgeDays": 30
    },
    "security": {
      "passwordExpiryDaysWarning": 90,
      "certificateExpiryDaysWarning": 30,
      "securityAlertSeverity": ["High", "Medium"]
    },
    "reliability": {
      "backupRetentionDaysMinimum": 30,
      "availabilityZoneMinimum": 2,
      "maxRtoHours": 4,
      "maxRpoHours": 1
    },
    "performance": {
      "cpuThresholdPercent": 80,
      "memoryThresholdPercent": 85,
      "diskThresholdPercent": 90
    }
  },
  
  "resourceFilters": {
    "excludeTags": [
      "Environment=Dev",
      "Temporary=True"
    ],
    
    "includeTags": [],
    
    "excludeResourceGroups": [
      "NetworkWatcherRG",
      "cloud-shell-storage-*"
    ],
    
    "includeResourceGroups": [],
    
    "excludeResourceTypes": [
      "microsoft.alertsmanagement/smartdetectoralertrules"
    ],
    
    "excludeResourceNames": []
  },
  
  "retryPolicy": {
    "maxAttempts": 3,
    "delaySeconds": 2,
    "exponentialBackoff": true,
    "retryableStatusCodes": [429, 500, 502, 503, 504]
  },
  
  "caching": {
    "enabled": true,
    "durationMinutes": 30,
    "cacheResourceGraph": true,
    "cacheAdvisor": true,
    "cachePolicyInsights": false
  },
  
  "performance": {
    "parallelSubscriptions": true,
    "maxParallelism": 5,
    "timeoutSeconds": 300,
    "batchResourceGraphQueries": true,
    "resourceGraphBatchSize": 1000
  },
  
  "reporting": {
    "includeRecommendations": true,
    "includeRemediationSteps": true,
    "includeCostEstimates": true,
    "prioritizeByRisk": true,
    "groupByPillar": true,
    "includeExecutiveSummary": true,
    "complianceFrameworks": ["CIS", "ISO27001", "NIST"],
    "riskScoring": {
      "enabled": true,
      "weights": {
        "Security": 30,
        "Reliability": 25,
        "Performance": 15,
        "CostOptimization": 15,
        "OperationalExcellence": 15
      }
    }
  },
  
  "notifications": {
    "enabled": false,
    "webhook": {
      "url": "",
      "method": "POST",
      "headers": {}
    },
    "email": {
      "enabled": false,
      "smtpServer": "",
      "from": "",
      "to": [],
      "onlyOnFailures": true
    },
    "teams": {
      "enabled": false,
      "webhookUrl": ""
    },
    "slack": {
      "enabled": false,
      "webhookUrl": ""
    }
  },
  
  "dataRetention": {
    "keepReportsForDays": 90,
    "autoCleanup": true,
    "archiveOldReports": true,
    "archivePath": "./waf-archive"
  },
  
  "security": {
    "obfuscateSensitiveData": false,
    "excludeResourceNames": false,
    "hashSubscriptionIds": false,
    "sanitizeOutputs": false
  },
  
  "apiSettings": {
    "resourceGraph": {
      "maxRecords": 1000,
      "skipTokenEnabled": true,
      "queryTimeout": 180
    },
    "advisor": {
      "includeSuppressions": false,
      "categoryFilter": ["Cost", "Security", "Reliability", "Performance", "OperationalExcellence"]
    },
    "defender": {
      "includeRecommendations": true,
      "includeAlerts": true,
      "severityFilter": ["High", "Medium", "Low"]
    },
    "costManagement": {
      "forecastDays": 30,
      "includeTagBreakdown": true
    }
  },
  
  "customChecks": {
    "enabled": true,
    "checkPaths": [
      "./custom-checks"
    ]
  },
  
  "baseline": {
    "enabled": false,
    "baselinePath": "./baseline.json",
    "compareOnScan": true,
    "updateBaseline": false
  }
}
```
